<!DOCTYPE html>
<html>

<head>

<body>
  <div class="container">
    <br>
    <div class="jumbotron">
      <h1 class="display-4">Send Message</h1>
      <br>
      <input id="name" class="form-control" placeholder="Name">
      <br>
      <textarea id="message" class="form-control" placeholder="Your Message Here">
</textarea>
      <br>
      <button id="send" class="btn btn-success">Send</button>
    </div>
    <div id="messages">

    </div>
  </div>
  <script>

    src = "/socket.io/socket.io.js" >

      document.getElementById("send").addEventListener("click", function () {
        // Obtendo os valores do formulário
        let name = document.getElementById("name").value;
        let message = document.getElementById("message").value;

        // Validando se os campos não estão vazios
        if (!name.trim() || !message.trim()) {
          alert("Name and message fields cannot be empty!");
          return;
        }

        // Preparando os dados para serem enviados
        let data = {
          name: name,
          message: message
        };

        // Criando um objeto XMLHttpRequest
        let xhr = new XMLHttpRequest();
        xhr.open("POST", "/messages", true);
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            alert("Message sent successfully!");
            // Limpar campos após o envio
            document.getElementById("name").value = "";
            document.getElementById("message").value = "";
          } else if (this.readyState == 4) {
            alert("Error sending the message.");
          }
        };

        // Enviando a solicitação
        xhr.send(JSON.stringify(data));
      });
  </script>
</body>

</html>
